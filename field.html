<!DOCTYPE html>
<html lang="en">
<head>
    <title>Your Crop!</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="main.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>    
    <script src="config.js"></script>
</head>
<body>
    <div id="add-crop"></div>
    <div id="get-agronomic"></div>
    <h1  id="crop-name"></h1> 
    <div id="crop-img"></div>
    <div id="crop-facts"></div>
    <div id="weather"></div>   
</body>

<script>
const urlv2 = new URL(window.location)
const paramsv2 = new URLSearchParams(urlv2.search)
const uri = '/v2/weather/fields/' + paramsv2.get("fieldId") + '/forecasts?units=usa&limit=3&offset=3'
var elem = document.createElement('a')
elem.href = 'addCrop?fieldId=' + paramsv2.get("fieldId")
elem.innerHTML = '<button>Add a crop to this field</button>'
var agro = document.createElement('a')
agro.href = 'agronomic/fields/' + paramsv2.get("fieldId") + '/agronomicnorms?unints=usa'
agro.innerHTML = '<button>Check out historical agronomic data</button>'
document.getElementById('add-crop').appendChild(elem)
document.getElementById('get-agronomic').appendChild(agro)

$.ajax({
    url: host + uri,
    type: "GET",
    beforeSend: (xhr) => {xhr.setRequestHeader('Authorization', 'Bearer ' + TOKEN)},
    success: (response) => {
        console.log(response.forecasts[0])  
        for(var i = 0; i < 3;i++){
            console.log('date = ' + response.forecasts[i].date);
            $('#weather').append(
                '<li>'+ 'date = ' + response.forecasts[i].date
            )
            for(var j = 0; j < 24; j++){
                console.log(response.forecasts[i].forecast[j].conditionsText);
                const v = j+1
                $('#weather').append(
                    '<li>Hour:' + j + '-' + v + ' ' + response.forecasts[i].forecast[j].conditionsText 
                )
            }
        }
    }
})
</script>
</html